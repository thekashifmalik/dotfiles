#!/bin/bash
set -eo pipefail

[[ -z $1 ]] && echo "No key provided" && exit 1
KEY=$1
[[ -z $2 ]] && echo "No file provided" && exit 1
VAULT=$2

FILE=${VAULT#vault/}
mkdir -pv `dirname $FILE`

cat $VAULT | openssl/bin/decrypt $KEY | tar/bin/extract $FILE
echo "> decrypted '$VAULT' -> '$FILE'"
