#!/bin/bash
set -eo pipefail

[[ -z $1 ]] && echo "No key provided" && exit 1
KEY=$1
[[ -z $2 ]] && echo "No file provided" && exit 1
VAULT_FILE=$2

FILE=${VAULT_FILE#vault/}
mkdir -pv `dirname $FILE`

cat $VAULT_FILE | openssl/bin/decrypt $KEY | tar -xv
echo "> decrypted '$VAULT_FILE' -> '$FILE'"
