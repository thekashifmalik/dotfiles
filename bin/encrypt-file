#!/bin/bash
set -eo pipefail

[[ -z $1 ]] && echo "No key provided" && exit 1
KEY=$1
[[ -z $2 ]] && echo "No file provided" && exit 1
FILE=$2

VAULT_FILE=vault/$FILE
mkdir -pv `dirname $VAULT_FILE`

tar -cv $FILE | openssl/bin/encrypt $KEY > $VAULT_FILE
echo "> encrypted '$FILE' -> '$VAULT_FILE'"
